<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lab Exam Portal</title>
  <link rel="stylesheet" href="../css/result.css" />
  <link href="../images/christpic2.jpg" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1>üìÑ Academic Results</h1>

    <div class="tabs-wrapper">
      <input type="radio" id="radio-cia1" name="resultType" value="cia1" checked>
      <label for="radio-cia1">CIA 1</label>
      <table id="cia1" class="result-table">
        <thead>
          <tr><th>Subject</th><th>Code</th><th>Marks</th></tr>
        </thead>
        <tbody>
          <tr><td>Machine Learning</td><td>CSEAM531P</td><td>12</td></tr>
          <tr><td>Cloud Computing</td><td>CSE532P</td><td>14</td></tr>
          <tr><td>Cryptography</td><td>CSE535</td><td>15</td></tr>
          <tr><td>Internet & Web Programming</td><td>CSE534P</td><td>13</td></tr>
          <tr><td>Design & Analysis of Algorithms</td><td>CSE533</td><td>14</td></tr>
          <tr><td>Drone Technologies</td><td>BTES552</td><td>13</td></tr>
          <tr><td>SE & Project Management</td><td>HS522</td><td>14</td></tr>
          <tr><td>Ability Enhancement Course-V</td><td>OEC572</td><td>13</td></tr>
        </tbody>
      </table>

      <input type="radio" id="radio-midsem" name="resultType" value="midsem">
      <label for="radio-midsem">Mid-Sem</label>
      <table id="midsem" class="result-table">
        <thead>
          <tr><th>Subject</th><th>Code</th><th>Marks</th></tr>
        </thead>
        <tbody>
          <tr><td>Machine Learning</td><td>CSEAM531P</td><td>24</td></tr>
          <tr><td>Cloud Computing</td><td>CSE532P</td><td>22</td></tr>
          <tr><td>Cryptography</td><td>CSE535</td><td>23</td></tr>
          <tr><td>Internet & Web Programming</td><td>CSE534P</td><td>22</td></tr>
          <tr><td>Design & Analysis of Algorithms</td><td>CSE533</td><td>20</td></tr>
          <tr><td>Drone Technologies</td><td>BTES552</td><td>21</td></tr>
          <tr><td>SE & Project Management</td><td>HS522</td><td>23</td></tr>
          <tr><td>Ability Enhancement Course-V</td><td>OEC572</td><td>22</td></tr>
        </tbody>
      </table>

      <input type="radio" id="radio-cia3" name="resultType" value="cia3">
      <label for="radio-cia3">CIA 3</label>
      <table id="cia3" class="result-table">
        <thead>
          <tr><th>Subject</th><th>Code</th><th>Marks</th></tr>
        </thead>
        <tbody>
          <tr><td>Machine Learning</td><td>CSEAM531P</td><td>14</td></tr>
          <tr><td>Cloud Computing</td><td>CSE532P</td><td>12</td></tr>
          <tr><td>Cryptography</td><td>CSE535</td><td>13</td></tr>
          <tr><td>Internet & Web Programming</td><td>CSE534P</td><td>12</td></tr>
          <tr><td>Design & Analysis of Algorithms</td><td>CSE533</td><td>13</td></tr>
          <tr><td>Drone Technologies</td><td>BTES552</td><td>14</td></tr>
          <tr><td>SE & Project Management</td><td>HS522</td><td>12</td></tr>
          <tr><td>Ability Enhancement Course-V</td><td>OEC572</td><td>14</td></tr>
        </tbody>
      </table>

      <input type="radio" id="radio-endsem" name="resultType" value="endsem">
      <label for="radio-endsem">End-Sem</label>
      <table id="endsem" class="result-table">
        <thead>
          <tr><th>Subject</th><th>Code</th><th>Marks</th></tr>
        </thead>
        <tbody>
          <tr><td>Machine Learning</td><td>CSEAM531P</td><td>55</td></tr>
          <tr><td>Cloud Computing</td><td>CSE532P</td><td>52</td></tr>
          <tr><td>Cryptography</td><td>CSE535</td><td>58</td></tr>
          <tr><td>Internet & Web Programming</td><td>CSE534P</td><td>51</td></tr>
          <tr><td>Design & Analysis of Algorithms</td><td>CSE533</td><td>49</td></tr>
          <tr><td>Drone Technologies</td><td>BTES552</td><td>50</td></tr>
          <tr><td>SE & Project Management</td><td>HS522</td><td>48</td></tr>
          <tr><td>Ability Enhancement Course-V</td><td>OEC572</td><td>53</td></tr>
        </tbody>
      </table>

      <input type="radio" id="radio-final" name="resultType" value="final">
      <label for="radio-final">Final Marksheet</label>
      <table id="final" class="result-table">
        <thead>
          <tr>
            <th>Subject</th><th>Code</th><th>CIA 1</th><th>Midsem</th><th>CIA 3</th><th>End-Sem</th><th>Grade</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Machine Learning</td><td>CSEAM531P</td><td>12</td><td>24</td><td>14</td><td>55</td><td>A</td></tr>
          <tr><td>Cloud Computing</td><td>CSE532P</td><td>14</td><td>22</td><td>12</td><td>52</td><td>A</td></tr>
          <tr><td>Cryptography</td><td>CSE535</td><td>15</td><td>23</td><td>13</td><td>58</td><td>A+</td></tr>
          <tr><td>Internet & Web Programming</td><td>CSE534P</td><td>13</td><td>22</td><td>12</td><td>51</td><td>A</td></tr>
          <tr><td>Design & Analysis of Algorithms</td><td>CSE533</td><td>14</td><td>20</td><td>13</td><td>49</td><td>B+</td></tr>
          <tr><td>Drone Technologies</td><td>BTES552</td><td>13</td><td>21</td><td>14</td><td>50</td><td>A</td></tr>
          <tr><td>SE & Project Management</td><td>HS522</td><td>14</td><td>23</td><td>12</td><td>48</td><td>B+</td></tr>
          <tr><td>AEC-V</td><td>OEC572</td><td>13</td><td>22</td><td>14</td><td>53</td><td>A</td></tr>
        </tbody>
      </table>

      <div class="result-summary" id="final-summary">
        <p><strong>GPA:</strong> 9.2</p>
        <p><strong>Status:</strong> üèÖ First Class with Distinction</p>
      </div>
    </div> 

    <a href="../html/student.html" class="back-btn">‚Üê Back to Dashboard</a>
  </div>
</body>
</html> -->




<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="../images/favicon.png" sizes="8x8" type="image/png">
  <title>Results ‚Äî Lab Exam Portal</title>
  <link rel="stylesheet" href="../css/result.css" />
</head>
<body>
  <input type="radio" name="result-tab" id="radio-midsem" checked />
  <input type="radio" name="result-tab" id="radio-endsem" />

  <header class="site-header" role="banner">
    <div class="header-inner">
      <img src="../images/christlogo.png" alt="Christ University logo" class="logo" />
      <div class="brand">
        <span class="dept">Department of AIML and Data Science</span>
      </div>
      <div class="user-actions">
        <a href="../html/student.html" class="back-btn">Back to Dashboard</a>
      </div>
    </div>
  </header>

  <main class="results-wrapper" role="main">
    <section class="results-hero">
      <h1 class="title">Results</h1>
      <p class="subtitle">Check your lab exam scores and performance</p>
    </section>

    <div class="tabs-wrapper">
      <label for="radio-midsem" class="tab-btn">Mid-sem Lab</label>
      <label for="radio-endsem" class="tab-btn">End-sem Lab</label>
    </div>

    <div class="table-container">
      <table class="result-table midsem-table" aria-label="Mid-sem Lab Results">
        <thead>
          <tr>
            <th>Subject</th>
            <th>Code</th>
            <th>Writeup</th>
            <th>Execution</th>
            <th>Viva</th>
            <th>Marks</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Machine Learning</td>
            <td>CSEAM531P</td>
            <td class="marks-cell"></td>
            <td class="marks-cell">24</td>
          </tr>
          <tr>
            <td>Cloud Computing</td>
            <td>CSE532P</td>
            <td class="marks-cell">22</td>
          </tr>
          <tr>
            <td>Cryptography</td>
            <td>CSE535</td>
            <td class="marks-cell">23</td>
          </tr>
          <tr>
            <td>Internet & Web Programming</td>
            <td>CSE534P</td>
            <td class="marks-cell">22</td>
          </tr>
          <tr>
            <td>Design & Analysis of Algorithms</td>
            <td>CSE533</td>
            <td class="marks-cell">20</td>
          </tr>
          <tr>
            <td>Drone Technologies</td>
            <td>BTES552</td>
            <td class="marks-cell">21</td>
          </tr>
          <tr>
            <td>SE & Project Management</td>
            <td>HS522</td>
            <td class="marks-cell">23</td>
          </tr>
          <tr>
            <td>Ability Enhancement Course-V</td>
            <td>OEC572</td>
            <td class="marks-cell">22</td>
          </tr>
        </tbody>
      </table>

      <table class="result-table endsem-table" aria-label="End-sem Lab Results">
        <thead>
          <tr>
            <th>Subject</th>
            <th>Code</th>
            <th>Writeup</th>
            <th>Execution</th>
            <th>Viva</th>
            <th>Marks</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Machine Learning</td>
            <td>CSEAM531P</td>
            <td class="marks-cell">55</td>
          </tr>
          <tr>
            <td>Cloud Computing</td>
            <td>CSE532P</td>
            <td class="marks-cell">52</td>
          </tr>
          <tr>
            <td>Cryptography</td>
            <td>CSE535</td>
            <td class="marks-cell">58</td>
          </tr>
          <tr>
            <td>Internet & Web Programming</td>
            <td>CSE534P</td>
            <td class="marks-cell">51</td>
          </tr>
          <tr>
            <td>Design & Analysis of Algorithms</td>
            <td>CSE533</td>
            <td class="marks-cell">49</td>
          </tr>
          <tr>
            <td>Drone Technologies</td>
            <td>BTES552</td>
            <td class="marks-cell">50</td>
          </tr>
          <tr>
            <td>SE & Project Management</td>
            <td>HS522</td>
            <td class="marks-cell">48</td>
          </tr>
          <tr>
            <td>Ability Enhancement Course-V</td>
            <td>OEC572</td>
            <td class="marks-cell">53</td>
          </tr>
        </tbody>
      </table>
    </div>
  </main>
</body>
</html> -->



<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exam Results - Lab Exam Portal</title>
  <link rel="stylesheet" href="../css/result.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
</head>
<body>
  <!-- Animated Background 
  <div class="bg-animation">
    <div class="floating-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
      <div class="shape shape-4"></div>
    </div>
  </div>

  <!-- Header 
  <header class="site-header">
    <div class="header-inner">
      <img src="../images/christlogo.png" alt="Christ University logo" class="logo" />
      <div class="brand">
        <span class="dept">Department of AIML and Data Science</span>
      </div>
      <div class="user-actions">
        <a href="../html/student.html" class="back-btn">‚Üê Back to Dashboard</a>
      </div>
    </div>
  </header>

  <!-- Main Content 
  <div class="results-root">
    <!-- Tab Radio Inputs 
    <input type="radio" name="result-tab" id="tab1" checked />
    <input type="radio" name="result-tab" id="tab2" />

    <main class="results-wrapper">
      <section class="results-hero">
        <h1 class="title gradient-text">Exam Results</h1>
        <p class="subtitle">Check your lab exam scores and performance</p>
      </section>

      <!-- Tab Controls 
      <div class="tabs-wrapper">
        <label for="tab1" class="tab-btn">Mid Semester Results</label>
        <label for="tab2" class="tab-btn">End Semester Results</label>
      </div>

      <!-- Results Tables 
      <div class="table-container">
        <table class="result-table midsem-table">
          <thead>
            <tr>
              <th>Subject</th>
              <th>Code</th>
              <th>Writeup</th>
              <th>Execution</th>
              <th>Viva</th>
              <th>Total Marks</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Machine Learning</td>
              <td>CSEAM531P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Cloud Computing</td>
              <td>CSE532P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Internet & Web Programming</td>
              <td>CSE534P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Drone Technologies</td>
              <td>BTES552</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
          </tbody>
        </table>

        <table class="result-table endsem-table">
          <thead>
            <tr>
              <th>Subject</th>
              <th>Code</th>
              <th>Writeup</th>
              <th>Execution</th>
              <th>Viva</th>
              <th>Total Marks</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Machine Learning</td>
              <td>CSEAM531P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Cloud Computing</td>
              <td>CSE532P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Internet & Web Programming</td>
              <td>CSE534P</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
            <tr>
              <td>Drone Technologies</td>
              <td>BTES552</td>
              <td></td>
              <td></td>
              <td></td>
              <td class="marks-cell"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </main>
  </div>
</body>
</html> -->


<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Results - Student Portal</title>
    <link rel="stylesheet" href="../css/result.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>My Lab Results</h1>
            <p id="studentInfo">Loading student information...</p>
        </div>

        <div class="results-container" id="resultsContainer">
            <div class="loading">Loading your results...</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Get student data from localStorage (set during login)
            const studentData = JSON.parse(localStorage.getItem('studentData'));
            
            if (!studentData || !studentData.reg_no) {
                document.getElementById('studentInfo').textContent = 'Please log in to view results';
                document.getElementById('resultsContainer').innerHTML = '<div class="error">Please log in to view your results</div>';
                return;
            }

            // Display student info
            document.getElementById('studentInfo').textContent = `${studentData.name} (${studentData.reg_no})`;

            try {
                // Fetch results from server
                const response = await fetch(`/api/results/${studentData.reg_no}`);
                const data = await response.json();

                if (response.ok && data.success) {
                    displayResults(data.results);
                } else {
                    document.getElementById('resultsContainer').innerHTML = '<div class="error">Failed to load results</div>';
                }
            } catch (error) {
                console.error('Error fetching results:', error);
                document.getElementById('resultsContainer').innerHTML = '<div class="error">Network error. Please try again later.</div>';
            }
        });

        function displayResults(results) {
            const container = document.getElementById('resultsContainer');
            
            if (results.length === 0) {
                container.innerHTML = '<div class="no-results">No results available yet</div>';
                return;
            }

            let html = `
                <div class="results-grid">
            `;
            
            results.forEach(result => {
                const midTotal = (result.midsem_w || 0) + (result.midsem_e || 0) + (result.midsem_v || 0);
                const endTotal = (result.endsem_w || 0) + (result.endsem_e || 0) + (result.endsem_v || 0);
                const grandTotal = midTotal + endTotal;
                
                html += `
                    <div class="subject-card">
                        <div class="subject-header">
                            <h3>${result.subject_name}</h3>
                            <span class="subject-code">${result.subject_code}</span>
                        </div>
                        
                        <div class="marks-section">
                            <div class="exam-type">
                                <h4>Mid Semester</h4>
                                <div class="marks-breakdown">
                                    <div class="mark-item">
                                        <span>Writeup:</span>
                                        <span class="mark-value">${result.midsem_w || 0}/25</span>
                                    </div>
                                    <div class="mark-item">
                                        <span>Execution:</span>
                                        <span class="mark-value">${result.midsem_e || 0}/25</span>
                                    </div>
                                    <div class="mark-item">
                                        <span>Viva:</span>
                                        <span class="mark-value">${result.midsem_v || 0}/25</span>
                                    </div>
                                </div>
                                <div class="total-marks">
                                    Total: <strong>${midTotal}/75</strong>
                                </div>
                            </div>
                            
                            <div class="exam-type">
                                <h4>End Semester</h4>
                                <div class="marks-breakdown">
                                    <div class="mark-item">
                                        <span>Writeup:</span>
                                        <span class="mark-value">${result.endsem_w || 0}/25</span>
                                    </div>
                                    <div class="mark-item">
                                        <span>Execution:</span>
                                        <span class="mark-value">${result.endsem_e || 0}/25</span>
                                    </div>
                                    <div class="mark-item">
                                        <span>Viva:</span>
                                        <span class="mark-value">${result.endsem_v || 0}/25</span>
                                    </div>
                                </div>
                                <div class="total-marks">
                                    Total: <strong>${endTotal}/75</strong>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grand-total ${getGradeClass(grandTotal)}">
                            Grand Total: ${grandTotal}/150
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        function getGradeClass(total) {
            if (total >= 135) return 'grade-a';
            if (total >= 120) return 'grade-b';
            if (total >= 105) return 'grade-c';
            if (total >= 90) return 'grade-d';
            return 'grade-f';
        }
        
        // Add styling
        const style = document.createElement('style');
        style.textContent = `
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
                background: linear-gradient(135deg, #0f1729, #1e293b);
                color: #f1f5f9;
                min-height: 100vh;
                padding: 20px;
            }
            
            .container {
                max-width: 1200px;
                margin: 0 auto;
            }
            
            .header {
                text-align: center;
                margin-bottom: 40px;
            }
            
            .header h1 {
                font-size: 2.5rem;
                font-weight: 700;
                background: linear-gradient(135deg, #60a5fa, #34d399);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                margin-bottom: 10px;
            }
            
            .results-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                gap: 24px;
            }
            
            .subject-card {
                background: rgba(30, 41, 59, 0.95);
                border: 1px solid rgba(96, 165, 250, 0.15);
                border-radius: 16px;
                padding: 24px;
                box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
                backdrop-filter: blur(6px);
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }
            
            .subject-card:hover {
                transform: translateY(-4px);
                box-shadow: 0 16px 44px rgba(0, 0, 0, 0.25);
            }
            
            .subject-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
                padding-bottom: 16px;
                border-bottom: 1px solid rgba(96, 165, 250, 0.15);
            }
            
            .subject-header h3 {
                font-size: 1.4rem;
                font-weight: 600;
                color: #60a5fa;
            }
            
            .subject-code {
                background: linear-gradient(135deg, #34d399, #4caf50);
                color: white;
                padding: 4px 12px;
                border-radius: 8px;
                font-size: 0.85rem;
                font-weight: 600;
            }
            
            .marks-section {
                display: grid;
                gap: 20px;
                margin-bottom: 20px;
            }
            
            .exam-type h4 {
                color: #cbd5e1;
                font-size: 1.1rem;
                margin-bottom: 12px;
                font-weight: 600;
            }
            
            .marks-breakdown {
                background: rgba(255, 255, 255, 0.05);
                border-radius: 8px;
                padding: 12px;
                margin-bottom: 12px;
            }
            
            .mark-item {
                display: flex;
                justify-content: space-between;
                margin-bottom: 8px;
                font-size: 0.95rem;
            }
            
            .mark-item:last-child {
                margin-bottom: 0;
            }
            
            .mark-value {
                font-weight: 600;
                color: #60a5fa;
            }
            
            .total-marks {
                text-align: right;
                font-size: 1.05rem;
                color: #34d399;
            }
            
            .grand-total {
                text-align: center;
                font-size: 1.3rem;
                font-weight: 700;
                padding: 12px;
                border-radius: 8px;
                margin-top: 16px;
            }
            
            .grade-a { background: linear-gradient(135deg, #34d399, #4caf50); color: white; }
            .grade-b { background: linear-gradient(135deg, #60a5fa, #3b82f6); color: white; }
            .grade-c { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: white; }
            .grade-d { background: linear-gradient(135deg, #fb923c, #f97316); color: white; }
            .grade-f { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
            
            .loading, .error, .no-results {
                text-align: center;
                padding: 40px;
                font-size: 1.2rem;
                color: #cbd5e1;
            }
            
            .error {
                color: #ef4444;
            }
            
            @media (max-width: 768px) {
                .results-grid {
                    grid-template-columns: 1fr;
                }
                
                .subject-header {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 8px;
                }
                
                .header h1 {
                    font-size: 2rem;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Results - CHRIST University</title>
    <link rel="stylesheet" href="../css/result.css">
    <link rel="icon" href="../images/christlogo.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <!-- Header -->
    <header class="site-header">
        <div class="header-inner">
            <img src="../images/christlogo.png" alt="Christ University" class="logo">
            <div class="brand">
                <div class="dept">Department of AIML and Data Science</div>
                <div class="subtitle">Lab Results Portal</div>
            </div>
            <div class="user-actions">
                <a href="../html/student.html" class="back-btn">‚Üê Back to Dashboard</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-wrapper">
        <!-- Loading State -->
        <div id="loadingContainer" class="loading-container">
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <p class="loading-text">Loading your results...</p>
        </div>

        <!-- Error State -->
        <div id="errorContainer" class="error-container" style="display: none;">
            <div class="error-icon">‚ö†Ô∏è</div>
            <h3>Unable to Load Results</h3>
            <p id="errorMessage">Please check your connection and try again.</p>
            <button onclick="loadResults()" class="retry-btn">üîÑ Retry</button>
        </div>

        <!-- Results Content -->
        <div id="resultsContainer" class="results-container" style="display: none;">
            <!-- Student Info Header -->
            <div class="student-info-card">
                <div class="student-avatar">
                    <div class="avatar-icon">üë®‚Äçüéì</div>
                </div>
                <div class="student-details">
                    <h2 id="studentFullName">Loading...</h2>
                    <div class="student-meta">
                        <span id="studentRegNo">-</span>
                        <span class="separator">‚Ä¢</span>
                        <span id="studentDept">-</span>
                        <span class="separator">‚Ä¢</span>
                        <span id="studentClass">-</span>
                    </div>
                </div>
                <div class="results-summary">
                    <div class="summary-stat">
                        <div class="stat-value" id="totalSubjects">-</div>
                        <div class="stat-label">Subjects</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-value" id="completedExams">-</div>
                        <div class="stat-label">Completed</div>
                    </div>
                    <div class="summary-stat">
                        <div class="stat-value" id="averageScore">-</div>
                        <div class="stat-label">Average</div>
                    </div>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="filter-section">
                <div class="filter-controls">
                    <div class="filter-group">
                        <label for="subjectFilter">Filter by Subject:</label>
                        <select id="subjectFilter" onchange="filterResults()">
                            <option value="">All Subjects</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="examFilter">Filter by Exam:</label>
                        <select id="examFilter" onchange="filterResults()">
                            <option value="">All Exams</option>
                            <option value="mid">Mid Semester</option>
                            <option value="end">End Semester</option>
                        </select>
                    </div>
                    <div class="search-group">
                        <input type="text" id="searchInput" placeholder="Search subjects..." onkeyup="filterResults()">
                        <span class="search-icon">üîç</span>
                    </div>
                </div>
            </div>

            <!-- Results Grid -->
            <div class="results-grid" id="resultsGrid">
                <!-- Results will be populated here -->
            </div>

            <!-- No Results Message -->
            <div id="noResultsMessage" class="no-results" style="display: none;">
                <div class="no-results-icon">üîç</div>
                <h3>No Results Found</h3>
                <p>No exam results match your current filters.</p>
            </div>
        </div>
    </div>

    <!-- Subject Detail Modal -->
    <div id="subjectModal" class="modal" style="display: none;">
        <div class="modal-backdrop" onclick="closeModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalSubjectName">Subject Details</h3>
                <button class="modal-close" onclick="closeModal()">‚úï</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let studentData = null;
        let resultsData = [];
        let filteredResults = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
            loadResults();
        });

        // Check if student is logged in
        function checkAuthentication() {
            const storedData = localStorage.getItem('studentData');
            const userType = localStorage.getItem('userType');

            if (!storedData || userType !== 'student') {
                console.log('‚ùå No student authentication found');
                window.location.href = 'student_login.html';
                return;
            }

            try {
                studentData = JSON.parse(storedData);
                console.log('‚úÖ Student authenticated:', studentData.name);

                // Update UI with student info
                document.getElementById('studentFullName').textContent = studentData.name || 'Student Name';
                document.getElementById('studentRegNo').textContent = `Reg: ${studentData.reg_no || 'N/A'}`;
                document.getElementById('studentDept').textContent = studentData.dept || 'Department';
                document.getElementById('studentClass').textContent = studentData.class || 'Class';
            } catch (error) {
                console.error('‚ùå Error parsing student data:', error);
                window.location.href = 'student_login.html';
            }
        }

        // Load results from server
        async function loadResults() {
            if (!studentData) return;

            showLoading(true);
            hideError();

            try {
                console.log(`üîç Fetching results for student: ${studentData.reg_no}`);

                const response = await fetch(`/api/results/${studentData.reg_no}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();
                console.log('üìä Results response:', data);

                if (response.ok && data.success) {
                    resultsData = data.results || [];
                    console.log(`‚úÖ Loaded ${resultsData.length} result records`);

                    if (resultsData.length > 0) {
                        displayResults();
                        updateSummary();
                        populateFilters();
                    } else {
                        showNoResults('No exam results found for your account.');
                    }
                } else {
                    throw new Error(data.message || 'Failed to load results');
                }
            } catch (error) {
                console.error('‚ùå Error loading results:', error);
                showError('Failed to load results. Please check your connection and try again.');
            } finally {
                showLoading(false);
            }
        }

        // Display results
        function displayResults() {
            const grid = document.getElementById('resultsGrid');
            const results = filteredResults.length > 0 ? filteredResults : resultsData;

            if (results.length === 0) {
                document.getElementById('noResultsMessage').style.display = 'block';
                grid.innerHTML = '';
                return;
            }

            document.getElementById('noResultsMessage').style.display = 'none';

            // Group results by subject
            const groupedResults = {};
            results.forEach(result => {
                if (!groupedResults[result.subject_code]) {
                    groupedResults[result.subject_code] = {
                        subject_code: result.subject_code,
                        subject_name: result.subject_name,
                        mid_semester: null,
                        end_semester: null
                    };
                }

                // Check if mid semester marks exist (changed from 75 to 50)
                if (result.midsem_final && result.midsem_final > 0) {
                    groupedResults[result.subject_code].mid_semester = {
                        writeup: result.midsem_w || 0,
                        execution: result.midsem_e || 0,
                        viva: result.midsem_v || 0,
                        total: result.midsem_final || 0
                    };
                }

                // Check if end semester marks exist (changed from 75 to 50)
                if (result.endsem_final && result.endsem_final > 0) {
                    groupedResults[result.subject_code].end_semester = {
                        writeup: result.endsem_w || 0,
                        execution: result.endsem_e || 0,
                        viva: result.endsem_v || 0,
                        total: result.endsem_final || 0
                    };
                }
            });

            // Generate HTML
            let html = '';
            Object.values(groupedResults).forEach(subject => {
                const midExists = subject.mid_semester !== null;
                const endExists = subject.end_semester !== null;

                html += `
                    <div class="result-card" data-subject="${subject.subject_code}" data-subject-name="${subject.subject_name}">
                        <div class="card-header">
                            <div class="subject-info">
                                <h3 class="subject-name">${subject.subject_name}</h3>
                                <span class="subject-code">${subject.subject_code}</span>
                            </div>
                            <div class="result-status">
                                ${midExists || endExists ? '<span class="status-badge completed">‚úÖ Results Available</span>' : '<span class="status-badge pending">‚è≥ Pending</span>'}
                            </div>
                        </div>

                        <div class="exam-sections">
                            <!-- Mid Semester Results -->
                            <div class="exam-section ${midExists ? 'has-results' : 'no-results'}">
                                <div class="exam-header">
                                    <h4>üìù Mid Semester</h4>
                                    <span class="exam-total">
                                        ${midExists ? `${subject.mid_semester.total}/50` : 'Not Available'}
                                    </span>
                                </div>
                                ${midExists ? `
                                    <div class="marks-grid">
                                        <div class="mark-item">
                                            <span class="mark-label">Writeup</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.mid_semester.writeup/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.mid_semester.writeup}/25</span>
                                            </div>
                                        </div>
                                        <div class="mark-item">
                                            <span class="mark-label">Execution</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.mid_semester.execution/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.mid_semester.execution}/25</span>
                                            </div>
                                        </div>
                                        <div class="mark-item">
                                            <span class="mark-label">Viva</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.mid_semester.viva/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.mid_semester.viva}/25</span>
                                            </div>
                                        </div>
                                    </div>
                                ` : `
                                    <div class="no-marks">
                                        <span class="no-marks-icon">‚è∞</span>
                                        <span>Results not yet published</span>
                                    </div>
                                `}
                            </div>

                            <!-- End Semester Results -->
                            <div class="exam-section ${endExists ? 'has-results' : 'no-results'}">
                                <div class="exam-header">
                                    <h4>üìã End Semester</h4>
                                    <span class="exam-total">
                                        ${endExists ? `${subject.end_semester.total}/50` : 'Not Available'}
                                    </span>
                                </div>
                                ${endExists ? `
                                    <div class="marks-grid">
                                        <div class="mark-item">
                                            <span class="mark-label">Writeup</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.end_semester.writeup/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.end_semester.writeup}/25</span>
                                            </div>
                                        </div>
                                        <div class="mark-item">
                                            <span class="mark-label">Execution</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.end_semester.execution/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.end_semester.execution}/25</span>
                                            </div>
                                        </div>
                                        <div class="mark-item">
                                            <span class="mark-label">Viva</span>
                                            <div class="mark-progress">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(subject.end_semester.viva/25)*100}%"></div>
                                                </div>
                                                <span class="mark-value">${subject.end_semester.viva}/25</span>
                                            </div>
                                        </div>
                                    </div>
                                ` : `
                                    <div class="no-marks">
                                        <span class="no-marks-icon">‚è∞</span>
                                        <span>Results not yet published</span>
                                    </div>
                                `}
                            </div>
                        </div>

                        <div class="card-footer">
                            <button class="details-btn" onclick="showSubjectDetails('${subject.subject_code}')">
                                üìä View Details
                            </button>
                            <div class="total-score">
                                <span>Total: ${(midExists ? subject.mid_semester.total : 0) + (endExists ? subject.end_semester.total : 0)}/100</span>
                            </div>
                        </div>
                    </div>
                `;
            });

            grid.innerHTML = html;
            document.getElementById('resultsContainer').style.display = 'block';
        }

        // Update summary statistics (changed for 50-point system)
        function updateSummary() {
            const subjects = new Set(resultsData.map(r => r.subject_code));
            const completedExams = resultsData.filter(r => 
                (r.midsem_final && r.midsem_final > 0) || (r.endsem_final && r.endsem_final > 0)
            ).length;

            // Calculate average (changed from 75 to 50)
            let totalMarks = 0;
            let totalPossible = 0;
            resultsData.forEach(r => {
                if (r.midsem_final && r.midsem_final > 0) {
                    totalMarks += r.midsem_final;
                    totalPossible += 50; // Changed from 75
                }
                if (r.endsem_final && r.endsem_final > 0) {
                    totalMarks += r.endsem_final;
                    totalPossible += 50; // Changed from 75
                }
            });

            const averagePercentage = totalPossible > 0 ? Math.round((totalMarks / totalPossible) * 100) : 0;

            document.getElementById('totalSubjects').textContent = subjects.size;
            document.getElementById('completedExams').textContent = completedExams;
            document.getElementById('averageScore').textContent = `${averagePercentage}%`;
        }

        // Populate filter dropdowns
        function populateFilters() {
            const subjectFilter = document.getElementById('subjectFilter');
            const subjects = [...new Set(resultsData.map(r => ({
                code: r.subject_code,
                name: r.subject_name
            })))];

            subjects.forEach(subject => {
                const option = document.createElement('option');
                option.value = subject.code;
                option.textContent = `${subject.name} (${subject.code})`;
                subjectFilter.appendChild(option);
            });
        }

        // Filter results
        function filterResults() {
            const subjectFilter = document.getElementById('subjectFilter').value;
            const examFilter = document.getElementById('examFilter').value;
            const searchInput = document.getElementById('searchInput').value.toLowerCase();

            filteredResults = resultsData.filter(result => {
                const matchesSubject = !subjectFilter || result.subject_code === subjectFilter;
                const matchesSearch = !searchInput || 
                    result.subject_name.toLowerCase().includes(searchInput) ||
                    result.subject_code.toLowerCase().includes(searchInput);

                let matchesExam = true;
                if (examFilter === 'mid') {
                    matchesExam = result.midsem_final && result.midsem_final > 0;
                } else if (examFilter === 'end') {
                    matchesExam = result.endsem_final && result.endsem_final > 0;
                }

                return matchesSubject && matchesSearch && matchesExam;
            });

            displayResults();
        }

        // Show subject details modal (updated for 50-point system)
        function showSubjectDetails(subjectCode) {
            const subject = resultsData.find(r => r.subject_code === subjectCode);
            if (!subject) return;

            document.getElementById('modalSubjectName').textContent = subject.subject_name;

            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                <div class="subject-details">
                    <div class="detail-section">
                        <h4>üìö Subject Information</h4>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Subject Code:</span>
                                <span class="detail-value">${subject.subject_code}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Subject Name:</span>
                                <span class="detail-value">${subject.subject_name}</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>üìä Exam Results</h4>
                        <div class="exam-comparison">
                            <div class="exam-column">
                                <h5>Mid Semester</h5>
                                ${subject.midsem_final > 0 ? `
                                    <div class="score-display">
                                        <div class="score-circle" data-progress="${(subject.midsem_final/50)*100}">
                                            <span class="score-text">${subject.midsem_final}/50</span>
                                        </div>
                                    </div>
                                    <div class="detailed-breakdown">
                                        <p>‚úèÔ∏è Writeup: <strong>${subject.midsem_w || 0}/25</strong></p>
                                        <p>‚öôÔ∏è Execution: <strong>${subject.midsem_e || 0}/25</strong></p>
                                        <p>üí¨ Viva: <strong>${subject.midsem_v || 0}/25</strong></p>
                                    </div>
                                ` : '<p class="no-result">‚è≥ Not yet published</p>'}
                            </div>

                            <div class="exam-column">
                                <h5>End Semester</h5>
                                ${subject.endsem_final > 0 ? `
                                    <div class="score-display">
                                        <div class="score-circle" data-progress="${(subject.endsem_final/50)*100}">
                                            <span class="score-text">${subject.endsem_final}/50</span>
                                        </div>
                                    </div>
                                    <div class="detailed-breakdown">
                                        <p>‚úèÔ∏è Writeup: <strong>${subject.endsem_w || 0}/25</strong></p>
                                        <p>‚öôÔ∏è Execution: <strong>${subject.endsem_e || 0}/25</strong></p>
                                        <p>üí¨ Viva: <strong>${subject.endsem_v || 0}/25</strong></p>
                                    </div>
                                ` : '<p class="no-result">‚è≥ Not yet published</p>'}
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>üìà Performance Summary</h4>
                        <div class="performance-stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Marks:</span>
                                <span class="stat-value">${(subject.midsem_final || 0) + (subject.endsem_final || 0)}/100</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Percentage:</span>
                                <span class="stat-value">${Math.round(((subject.midsem_final || 0) + (subject.endsem_final || 0))/100 * 100)}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('subjectModal').style.display = 'flex';
        }

        // Close modal
        function closeModal() {
            document.getElementById('subjectModal').style.display = 'none';
        }

        // Utility functions
        function showLoading(show) {
            document.getElementById('loadingContainer').style.display = show ? 'flex' : 'none';
        }

        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorContainer').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';
        }

        function hideError() {
            document.getElementById('errorContainer').style.display = 'none';
        }

        function showNoResults(message) {
            document.getElementById('resultsContainer').style.display = 'block';
            document.getElementById('resultsGrid').innerHTML = '';
            document.getElementById('noResultsMessage').style.display = 'block';
            document.getElementById('noResultsMessage').querySelector('p').textContent = message;
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('subjectModal');
            if (event.target === modal || event.target.classList.contains('modal-backdrop')) {
                closeModal();
            }
        }
    </script>
</body>
</html>