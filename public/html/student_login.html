<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="../images/favicon.png" sizes="8x8" type="image/png">
  <title>Student Login ‚Äî Lab Exam Portal</title>
  <link rel="stylesheet" href="../css//student_login.css" />
</head>
<body>
  <header class="site-header" role="banner">
    <div class="header-inner">
      <img src="../images/christlogo.png" alt="Christ University logo" class="logo" />
      <div class="brand">
        <span class="dept">Department of AIML and Data Science</span>
      </div>
      <div aria-hidden="true"></div>
    </div>
  </header>

  <main class="login-wrapper" role="main">
    <section class="login-card" aria-labelledby="loginTitle">
      <h1 id="loginTitle" class="title">Student Login</h1>
      <p class="subtitle">Sign in with university credentials to continue</p>

      <form id="loginForm" class="login-form" novalidate>
        <div class="field">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" autocomplete="username" required />
        </div>

        <div class="field">
          <label for="password">Password</label>
          <div class="password-wrapper">
            <input
              id="password"
              name="password"
              type="password"
              autocomplete="current-password"
              required
              minlength="4"
            />
            <button
              type="button"
              class="password-toggle"
              aria-label="Show password"
              aria-pressed="false"
              title="Show/Hide password"
            >
              <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7zm0 12a5 5 0 1 1 .001-10.001A5 5 0 0 1 12 17zm0-8a3 3 0 1 0 .001 6.001A3 3 0 0 0 12 9z"/>
              </svg>
            </button>
          </div>
        </div>

        <button class="submit-btn" type="submit">Sign in</button>
        <p id="loginError" role="alert" style="margin:8px 0 0; color:#c62828; display:none;"></p>
        <a class="back-link" href="../html/login_page.html">Back to role selection</a>
      </form>
    </section>
  </main>

  <script>
    // Password visibility toggle
    const toggleBtn = document.querySelector('.password-toggle');
    const pwd = document.getElementById('password');
    toggleBtn.addEventListener('click', () => {
      const wasPassword = pwd.type === 'password';
      pwd.type = wasPassword ? 'text' : 'password';
      toggleBtn.setAttribute('aria-pressed', String(wasPassword));
      toggleBtn.setAttribute('aria-label', wasPassword ? 'Hide password' : 'Show password');
    });

    // Submit handler using Fetch API
    const form = document.getElementById('loginForm');
    const errorEl = document.getElementById('loginError');

    form.addEventListener('submit', async (e) => {
      e.preventDefault(); // stop default navigation; validate with backend first
      errorEl.style.display = 'none';
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      try {
        const res = await fetch('/student/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });

        // In your student login success handler, add this line:
if (res.ok) {
  const data = await res.json();
  // Store the email for later use
  localStorage.setItem('studentEmail', email);
  window.location.href = '/html/student.html';
  return;
}

  

        const data = await res.json().catch(() => ({ message: 'Login failed' }));
        errorEl.textContent = data.message || 'Login failed';
        errorEl.style.display = 'block';
      } catch (err) {
        errorEl.textContent = 'Network error. Please try again.';
        errorEl.style.display = 'block';
      }
    });
  </script>
</body>
</html>


 -->


<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Login - Lab Exam Portal</title>
    <link rel="stylesheet" href="../css/student_login.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background Elements 
    <div class="bg-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <!-- Login Container 
    <div class="login-wrapper">
        <div class="login-header">
            <div class="login-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            </div>
            <h1>Student Portal</h1>
            <p class="login-subtitle">Access your exams and academic progress</p>
        </div>

        <!-- Error/Success Messages 
        <div id="messageContainer" class="message-container" style="display: none;">
            <p id="messageText"></p>
        </div>

        <form class="login-form" id="studentLoginForm">
            <div class="field">
                <label for="student-email">Email Address</label>
                <input type="email" id="student-email" name="email" placeholder="Enter your email address" required>
            </div>
            
            <div class="field">
                <label for="password">Password</label>
                <div class="password-wrapper">
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                    <button type="button" class="password-toggle" onclick="togglePassword()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="eye-open">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="eye-closed" style="display: none;">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="form-options">
                <label class="checkbox-container">
                    <input type="checkbox" id="remember">
                    <span class="checkmark"></span>
                    Remember me
                </label>
                <a href="#" class="forgot-link">Forgot Password?</a>
            </div>

            <button type="submit" class="submit-btn" id="loginButton">
                <span id="loginButtonText">Sign In</span>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="loginButtonIcon">
                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                </svg>
                <!-- Loading spinner (hidden by default)
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="loadingSpinner" style="display: none; animation: spin 1s linear infinite;">
                    <path d="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"/>
                </svg>
            </button>
        </form>

        <div class="login-footer">
            <p>Need help? <a href="#" class="register-link">Contact Admin</a></p>
            <a href="../html/login_page.html" class="back-link">‚Üê Back to Role Selection</a>
        </div>
    </div>

    <script>
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const eyeOpen = document.querySelector('.eye-open');
            const eyeClosed = document.querySelector('.eye-closed');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeOpen.style.display = 'none';
                eyeClosed.style.display = 'block';
            } else {
                passwordInput.type = 'password';
                eyeOpen.style.display = 'block';
                eyeClosed.style.display = 'none';
            }
        }

        // Show message function
        function showMessage(message, type = 'error') {
            const messageContainer = document.getElementById('messageContainer');
            const messageText = document.getElementById('messageText');
            
            messageText.textContent = message;
            messageContainer.className = `message-container ${type}`;
            messageContainer.style.display = 'block';
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                messageContainer.style.display = 'none';
            }, 5000);
        }

        // Loading state management
        function setLoadingState(isLoading) {
            const loginButton = document.getElementById('loginButton');
            const loginButtonText = document.getElementById('loginButtonText');
            const loginButtonIcon = document.getElementById('loginButtonIcon');
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            if (isLoading) {
                loginButton.disabled = true;
                loginButtonText.textContent = 'Signing In...';
                loginButtonIcon.style.display = 'none';
                loadingSpinner.style.display = 'block';
                loginButton.style.opacity = '0.7';
            } else {
                loginButton.disabled = false;
                loginButtonText.textContent = 'Sign In';
                loginButtonIcon.style.display = 'block';
                loadingSpinner.style.display = 'none';
                loginButton.style.opacity = '1';
            }
        }

        // Form submission
        document.getElementById('studentLoginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const email = formData.get('email');
            const password = formData.get('password');
            
            // Basic validation
            if (!email || !password) {
                showMessage('Please fill in all required fields.', 'error');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showMessage('Please enter a valid email address.', 'error');
                return;
            }
            
            setLoadingState(true);
            
            try {
                const response = await fetch('http://localhost:5000/student/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    // Login successful
                    showMessage('Login successful! Redirecting...', 'success');
                    
                    // Store student data in localStorage
                    localStorage.setItem('studentData', JSON.stringify(data.student));
                    localStorage.setItem('userType', 'student');
                    localStorage.setItem('isLoggedIn', 'true');
                    
                    // Redirect to student dashboard
                    setTimeout(() => {
                        window.location.href = '../html/student.html';
                    }, 1500);
                    
                } else {
                    // Login failed
                    showMessage(data.message || 'Invalid email or password. Please try again.', 'error');
                }
                
            } catch (error) {
                console.error('Login error:', error);
                showMessage('Unable to connect to the server. Please check your internet connection and try again.', 'error');
            } finally {
                setLoadingState(false);
            }
        });

        // Add CSS for loading spinner animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> -->





<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Login - Lab Exam Portal</title>
    <link rel="stylesheet" href="../css/student_login.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background Elements 
    <div class="bg-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <!-- Login Container 
    <div class="login-wrapper">
        <div class="login-header">
            <div class="login-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            </div>
            <h1>Student Portal</h1>
            <p class="login-subtitle">Access your exams and academic progress</p>
        </div>

        <!-- Error/Success Messages 
        <div id="messageContainer" class="message-container" style="display: none;">
            <p id="messageText"></p>
        </div>

        <form class="login-form" id="studentLoginForm">
            <div class="field">
                <label for="student-email">Email Address</label>
                <input type="email" id="student-email" name="email" placeholder="Enter your email address" required>
            </div>
            
            <div class="field">
                <label for="password">Password</label>
                <div class="password-wrapper">
                    <input type="password" id="password" name="password" placeholder="Enter your password" required>
                    <button type="button" class="password-toggle" onclick="togglePassword()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="eye-open">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="eye-closed" style="display: none;">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="form-options">
                <label class="checkbox-container">
                    <input type="checkbox" id="remember">
                    <span class="checkmark"></span>
                    Remember me
                </label>
                <a href="#" class="forgot-link">Forgot Password?</a>
            </div>

            <button type="submit" class="submit-btn" id="loginButton">
                <span id="loginButtonText">Sign In</span>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="loginButtonIcon">
                    <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
                </svg>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="loadingSpinner" style="display: none; animation: spin 1s linear infinite;">
                    <path d="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"/>
                </svg>
            </button>
        </form>

        <div class="login-footer">
            <p>Need help? <a href="#" class="register-link">Contact Admin</a></p>
            <a href="../html/login_page.html" class="back-link">‚Üê Back to Role Selection</a>
        </div>
    </div>

    <script>
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const eyeOpen = document.querySelector('.eye-open');
            const eyeClosed = document.querySelector('.eye-closed');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeOpen.style.display = 'none';
                eyeClosed.style.display = 'block';
            } else {
                passwordInput.type = 'password';
                eyeOpen.style.display = 'block';
                eyeClosed.style.display = 'none';
            }
        }

        function showMessage(message, type = 'error') {
            const messageContainer = document.getElementById('messageContainer');
            const messageText = document.getElementById('messageText');
            
            messageText.textContent = message;
            messageContainer.className = `message-container ${type}`;
            messageContainer.style.display = 'block';
            
            setTimeout(() => {
                messageContainer.style.display = 'none';
            }, 5000);
        }

        function setLoadingState(isLoading) {
            const loginButton = document.getElementById('loginButton');
            const loginButtonText = document.getElementById('loginButtonText');
            const loginButtonIcon = document.getElementById('loginButtonIcon');
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            if (isLoading) {
                loginButton.disabled = true;
                loginButtonText.textContent = 'Signing In...';
                loginButtonIcon.style.display = 'none';
                loadingSpinner.style.display = 'block';
                loginButton.style.opacity = '0.7';
            } else {
                loginButton.disabled = false;
                loginButtonText.textContent = 'Sign In';
                loginButtonIcon.style.display = 'block';
                loadingSpinner.style.display = 'none';
                loginButton.style.opacity = '1';
            }
        }

        document.getElementById('studentLoginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const email = formData.get('email');
            const password = formData.get('password');
            
            if (!email || !password) {
                showMessage('Please fill in all required fields.', 'error');
                return;
            }
            
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showMessage('Please enter a valid email address.', 'error');
                return;
            }
            
            setLoadingState(true);
            
            try {
                const response = await fetch('http://localhost:5000/student/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: email,
                        password: password
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showMessage('Login successful! Redirecting...', 'success');
                    
                    // Store student data
                    localStorage.setItem('studentData', JSON.stringify(data.student));
                    localStorage.setItem('userType', 'student');
                    localStorage.setItem('isLoggedIn', 'true');
                    
                    // Fixed redirect path - using the server route
                    setTimeout(() => {
                        window.location.href = '../html/student.html';
                    }, 1500);
                    
                } else {
                    showMessage(data.message || 'Invalid email or password. Please try again.', 'error');
                }
                
            } catch (error) {
                console.error('Login error:', error);
                showMessage('Unable to connect to the server. Please check your connection.', 'error');
            } finally {
                setLoadingState(false);
            }
        });

        // Add CSS for loading spinner
        const style = document.createElement('style');
        style.textContent = `
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> -->





<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Login - Lab Portal</title>
    <link rel="stylesheet" href="../css/student_login.css">
    <link rel="icon" href="../images/christlogo.png" type="image/png">
</head>
<body>
    <!-- Navigation Header -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-left">
                <img src="../images/christlogo.png" alt="Christ University" class="nav-logo">
                <div class="nav-brand">
                    <span class="brand-name">CHRIST</span>
                    <span class="brand-tagline">DEEMED TO BE UNIVERSITY</span>
                </div>
                <div class="nav-divider"></div>
                <div class="nav-title">
                    <h1>Department of AIML and Data Science</h1>
                    <span class="nav-subtitle">Advanced Learning Hub</span>
                </div>
            </div>
            <div class="nav-right">
                <a href="../html/login_page.html" class="nav-link">Home</a>
                <div class="support-dropdown">
                    <span>Support ‚ñæ</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Background Circles -->
    <div class="bg-circles">
        <div class="circle circle-1"></div>
        <div class="circle circle-2"></div>
        <div class="circle circle-3"></div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <div class="content-wrapper">
            <!-- Header Section -->
            <div class="header-section">
                <div class="platform-badge">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                    Student Portal Access
                </div>
                <h1 class="main-title">Student Access</h1>
                <p class="main-description">
                    Take exams, view results, and track your academic progress with our comprehensive student dashboard.
                </p>
            </div>

            <!-- Login Card -->
            <div class="login-card">
                <div class="card-header">
                    <div class="card-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <h2>Student Login</h2>
                    <p>Access your academic portal</p>
                </div>

                <!-- Login Method Toggle -->
                <div class="login-toggle">
                    <button type="button" class="toggle-btn active" onclick="showEmailLogin()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                        </svg>
                        Email Login
                    </button>
                    <button type="button" class="toggle-btn" onclick="showRegNoLogin()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21C3 22.11 3.89 23 5 23H11V21H5V3H13V9H21Z"/>
                        </svg>
                        Reg Number
                    </button>
                </div>

                <div class="login-form">
                    <!-- Email Login Section -->
                    <div id="emailLoginSection" class="login-section active">
                        <div class="form-group">
                            <label for="studentEmail">Email Address</label>
                            <input 
                                type="email" 
                                id="studentEmail" 
                                name="email" 
                                placeholder="Enter your college email"
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="studentPasswordEmail">Password</label>
                            <div class="password-field">
                                <input 
                                    type="password" 
                                    id="studentPasswordEmail" 
                                    name="password" 
                                    placeholder="Enter your password"
                                    required
                                >
                                <button type="button" class="password-toggle" onclick="togglePassword('studentPasswordEmail', this)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Registration Number Login Section -->
                    <div id="regNoLoginSection" class="login-section">
                        <div class="form-group">
                            <label for="regNo">Registration Number</label>
                            <input 
                                type="text" 
                                id="regNo" 
                                name="regNo" 
                                placeholder="Enter your registration number"
                            >
                        </div>

                        <div class="form-group">
                            <label for="studentPasswordReg">Password</label>
                            <div class="password-field">
                                <input 
                                    type="password" 
                                    id="studentPasswordReg" 
                                    name="password" 
                                    placeholder="Enter your password"
                                >
                                <button type="button" class="password-toggle" onclick="togglePassword('studentPasswordReg', this)">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="login-btn" onclick="handleLogin()">
                        <span class="btn-text">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            Access Student Portal
                        </span>
                        <span class="loading-spinner" style="display: none;">
                            <div class="spinner"></div>
                        </span>
                    </button>

                    <div id="messageContainer" class="message-container" style="display: none;"></div>
                </div>

                <div class="card-footer">
                    <div class="features-list">
                        <div class="feature-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            Real-time Results
                        </div>
                        <div class="feature-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            Study Materials
                        </div>
                        <div class="feature-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9 11H7v6h2v-6zm4 0h-2v6h2v-6zm4 0h-2v6h2v-6zm2.5-9H19v2h-1.5v17h-3v-17h-5v17h-3v-17H5V2H3.5V0h15z"/>
                            </svg>
                            Exam Schedule
                        </div>
                    </div>
                </div>
            </div>

            <!-- Alternative Access -->
            <div class="alternative-access">
                <span>Are you a faculty member?</span>
                <a href="../html/teacher-login.html" class="alt-link">Faculty Portal ‚Üí</a>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentLoginMethod = 'email';
        
        // Toggle between login methods
        function showEmailLogin() {
            document.getElementById('emailLoginSection').classList.add('active');
            document.getElementById('regNoLoginSection').classList.remove('active');
            document.querySelectorAll('.toggle-btn')[0].classList.add('active');
            document.querySelectorAll('.toggle-btn')[1].classList.remove('active');
            currentLoginMethod = 'email';
            clearForm();
        }
        
        function showRegNoLogin() {
            document.getElementById('emailLoginSection').classList.remove('active');
            document.getElementById('regNoLoginSection').classList.add('active');
            document.querySelectorAll('.toggle-btn')[0].classList.remove('active');
            document.querySelectorAll('.toggle-btn')[1].classList.add('active');
            currentLoginMethod = 'reg';
            clearForm();
        }
        
        // Toggle password visibility
        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            const isPassword = input.type === 'password';
            
            input.type = isPassword ? 'text' : 'password';
            
            const icon = button.querySelector('svg path');
            if (isPassword) {
                icon.setAttribute('d', 'M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7z');
            } else {
                icon.setAttribute('d', 'M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z');
            }
        }
        
        function clearForm() {
            document.getElementById('studentEmail').value = '';
            document.getElementById('studentPasswordEmail').value = '';
            document.getElementById('regNo').value = '';
            document.getElementById('studentPasswordReg').value = '';
            hideMessage();
        }
        
        function showMessage(message, type) {
            const container = document.getElementById('messageContainer');
            container.textContent = message;
            container.className = `message-container ${type}`;
            container.style.display = 'block';
            
            setTimeout(() => {
                container.style.display = 'none';
            }, type === 'error' ? 8000 : 4000);
        }
        
        function hideMessage() {
            const container = document.getElementById('messageContainer');
            container.style.display = 'none';
        }
        
        async function handleLogin() {
            let email = '';
            let regNo = '';
            let password = '';
            
            if (currentLoginMethod === 'email') {
                email = document.getElementById('studentEmail').value.trim();
                password = document.getElementById('studentPasswordEmail').value.trim();
                
                if (!email || !password) {
                    showMessage('Please fill in all fields', 'error');
                    return;
                }
            } else {
                regNo = document.getElementById('regNo').value.trim();
                password = document.getElementById('studentPasswordReg').value.trim();
                
                if (!regNo || !password) {
                    showMessage('Please fill in all fields', 'error');
                    return;
                }
            }
            
            // Show loading state
            const submitBtn = document.querySelector('.login-btn');
            const btnText = submitBtn.querySelector('.btn-text');
            const loadingSpinner = submitBtn.querySelector('.loading-spinner');
            
            submitBtn.disabled = true;
            btnText.style.display = 'none';
            loadingSpinner.style.display = 'flex';
            
            try {
                console.log('üîç Attempting student login:', currentLoginMethod === 'email' ? email : regNo);
                
                const response = await fetch('/student-login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        email: email || null, 
                        regNo: regNo || null, 
                        password: password 
                    })
                });
                
                const result = await response.json();
                console.log('üì° Server response:', result);
                
                if (response.ok && result.student) {
                    // CRITICAL: Store student data SYNCHRONOUSLY first
                    const studentData = {
                        reg_no: result.student.reg_no,
                        name: result.student.name,
                        email: result.student.email,
                        dept: result.student.dept,
                        class: result.student.class,
                        loginTime: new Date().getTime(),
                        authenticated: true
                    };
                    
                    // Store data synchronously
                    localStorage.setItem('studentData', JSON.stringify(studentData));
                    localStorage.setItem('userType', 'student');
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('authToken', 'student_' + new Date().getTime());
                    
                    console.log('‚úÖ Student data stored successfully:', studentData);
                    
                    showMessage(`Welcome ${result.student.name}!`, 'success');
                    
                    // Wait longer to ensure localStorage is written
                    setTimeout(() => {
                        console.log('üîÑ Redirecting to student.html');
                        console.log('üîç Verifying localStorage before redirect:', {
                            studentData: localStorage.getItem('studentData'),
                            userType: localStorage.getItem('userType'),
                            isLoggedIn: localStorage.getItem('isLoggedIn')
                        });
                        
                        // Force redirect
                        window.location.replace('student.html');
                    }, 2000); // Increased delay to 2 seconds
                } else {
                    showMessage(result.message || 'Login failed. Please check your credentials.', 'error');
                }
            } catch (error) {
                console.error('‚ùå Login error:', error);
                showMessage('Network error. Please check your connection and try again.', 'error');
            } finally {
                // Reset button state after longer delay
                setTimeout(() => {
                    submitBtn.disabled = false;
                    btnText.style.display = 'flex';
                    loadingSpinner.style.display = 'none';
                }, 2500);
            }
        }
        
        // Allow Enter key to trigger login
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });
        
        // Clear messages when user starts typing
        document.getElementById('studentEmail').addEventListener('input', hideMessage);
        document.getElementById('studentPasswordEmail').addEventListener('input', hideMessage);
        document.getElementById('regNo').addEventListener('input', hideMessage);
        document.getElementById('studentPasswordReg').addEventListener('input', hideMessage);
    </script>
</body>
</html>
